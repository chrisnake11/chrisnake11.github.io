---
title: 通道叠加的一维等宽量子卷积神经网络
published: 2024-09-29T15:41:51Z
description: '通道叠加的一维等宽量子卷积神经网络'
image: ''
tags: ['QCNN']
category: 'QCNN'
draft: true
---

# 基于通道叠加的量子卷积神经网络线路

设卷积层的输入信息通道为d，输出信息通道为d'

## 输出通道为1的情况

当d'=1时，输出通道为1，不需要额外的qubit。

![20240929154300](https://raw.githubusercontent.com/chrisnake11/picgo/main/blog/20240929154300.png)


**举例**

假设存在如下的数据：一共4个通道，每个通道为2 qubits

00 01  

01 10

10 11

11 00

![20240929160332](https://raw.githubusercontent.com/chrisnake11/picgo/main/blog/20240929160332.png)

由于00 01 10 11都是基向量，经过$H\otimes H$后，表示通道的qubits$\ket{00}$的系数都是$\frac{1}{2}$

得到的测量结果就是通道的数据系数取$\frac{1}{2}$，最后相加融合。

**卷积线路的解释**

1. 如图中可以看到，数据被编码为$\log_m$qubits，$\log_d$个qubits表示通道的索引。

2. 我们的卷积操作函数$G(r,k,\theta)$仅仅作用于$\log_m$个qubits，表示对每个通道的数据都执行一模一样的卷积操作。

3. 使用H门，生成一个均分叠加态，最后经过测量得到每个通道的平均融合的数据。

## 输出通道 > 1的情况

当d' > 1时，需要输出多个通道。就需要对不同的通道采用不一样的卷积参数。

![20240929160805](https://raw.githubusercontent.com/chrisnake11/picgo/main/blog/20240929160805.png)

**卷积神经网络的解释**

数据被编码为$\ket{\phi}$.

1. 加入了$\log d'$个qubits，经过H门的作用来拷贝出$d'$份相同的数据。
2. 经过一个CNOT门的作用，对拷贝出来的$d'$份数据采用不同的卷积门$r, k$和卷积参数$\theta$
3. 最后，经过$\log d$上的H门，将单份数据内部进行通道融合操作。
> 可以将$d'$个qubis看作把数据拷贝出多个副本。每个副本中都包含$d$个通道的数据。

# 量子循环卷积

循环卷积：将被卷积的**数据看作一个环**，从开头卷积到末尾。

卷积运算由**乘法、加法、移位**操作交替完成。

在量子循环卷积中,乘法操作由**张量运算**完成,移位操作和加法操作则分别由**振幅交换门和H门**实现。

![20240929202645](https://raw.githubusercontent.com/chrisnake11/picgo/main/blog/20240929202645.png)

$\ket{\omega}$和$\ket{\phi}$: 实现了张量乘法。

P门: 实现了移位操作。

H门: 首先得到均分叠加态，通过测量能够排除$\ket{\omega}$的影响，并且实现不同向量的加法运算。

当$\ket{\omega}$测量的结果为$\ket{0}$时，测量的结果为量子循环卷积的输出$\ket{o}$

![20240929202933](https://raw.githubusercontent.com/chrisnake11/picgo/main/blog/20240929202933.png)

# 等宽卷积的概念

**等宽卷积：**是指在**两边补零(padding zero)**，使得在卷积后，**输入和输出的大小相同**。
> 在量子中可以借助循环卷积的思路来实现等宽卷积。

![20240929201337](https://raw.githubusercontent.com/chrisnake11/picgo/main/blog/20240929201337.png)

图中:

$\ket{\mu}$表示编码得数据，$\ket{0}$用于量子补零，用来实现循环卷积操作。$\ket{v}$表示卷积核，作为相邻两个qubits的参数。

Q门：完成数据的循环右移，为实现循环卷积做准备。

P门：实现一维量子循环卷积。

H门：用于产生均分叠加态，使得测量的输出与$\ket{v}$无关。（将$\ket{v}$的影响排除）

当$\ket{v}$和$\ket{0}$测量结果为$\ket{0}$时，得到$\ket{\mu}$的循环卷积结果。

![20240929202954](https://raw.githubusercontent.com/chrisnake11/picgo/main/blog/20240929202954.png)

![20240929203004](https://raw.githubusercontent.com/chrisnake11/picgo/main/blog/20240929203004.png)

# QECNN-IR

![20240929204533](https://raw.githubusercontent.com/chrisnake11/picgo/main/blog/20240929204533.png)

$q_0, q_1$：用于拷贝出4个通道的数据，单个特征的输出通道为4

$q_2$：用于控制输出的特征数量为2.

$log d$ + H门：同一份数据中多个通道的卷积结果进行通道融合。

$log m$：编码的数据

$G(r, k, \theta)$：卷积核，对单份数据的不同通道执行相同的卷积操作（卷积核的参数共享）

$\Gamma(2, r, k, \Theta)$：2表示有两个卷积核，用与输出通道为2的特征数据，$\Theta$表示$G(r, k, \theta)$中$\theta$的集合。

## QECNN-IR结构总结
通过多个通道的并行计算，并且使用不同门数量的卷积核来模拟Inception在通道上的运算（区别在于，通道的数量都是4，只是做了一个并行计算）

对QCNN的输出结果在使用ResNet优化深度神经网络的训练效果（这一部分和量子其实关系不大）



